---
## Author
author:
  name: Ибрахим Мохсейн Алькамаль
  degrees: Student (3 курс)
  orcid: ""
  email: 1032225432@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №15
subtitle: "Дисциплина: Администрирование сетевых подсистем "
license: CC BY
date: today
date-format: "YYYY-MM-DD" # Example: 2025-09-06
---


# Цель работы

## Цель работы

- Получение навыков по работе с журналами системных событий


# Выполнение лабораторной работы

## Настройка сервера сетевого журнала

- Переход в каталог `/etc/rsyslog.d`
- Создание файла `netlog-server.conf`
- Подготовка конфигурации для сетевого хранения журналов

![Создание файла конфигурации rsyslog netlog-server.conf](image/1.png){#fig-1 width=70%}

---

- Включён приём журналов по TCP-порту 514
- Загружен модуль `imtcp`
- Активирован сервер ввода `$InputTCPServerRun 514`

![Настройка приёма журналов по TCP 514 в rsyslog](image/2.png){#fig-2 width=70%}

---


- Перезапущена служба `rsyslog`
- Выполнена проверка портов командой `lsof | grep TCP`
- Подтверждено состояние LISTEN для `rsyslog`

![Проверка прослушиваемых TCP-портов службой rsyslog](image/3.png){#fig-3 width=70%}

---

- Открыт TCP-порт 514 в `firewalld`
- Добавлено временное и постоянное правило
- Разрешён приём сетевых сообщений журнала

![Настройка firewalld для открытия TCP-порта 514](image/4.png){#fig-4 width=70%}

---

## Настройка клиента сетевого журнала

- Переход в каталог `/etc/rsyslog.d`
- Создание файла `netlog-client.conf`
- Подготовка конфигурации отправки журналов

![Создание файла конфигурации netlog-client.conf на клиенте](image/5.png){#fig-5 width=70%}

---

- Настроено перенаправление `*.* @@server.alkamal.net:514`
- Использован протокол TCP (`@@`)
- Организована передача всех сообщений на сервер
- Перезапущена служба `rsyslog`
- Применена новая конфигурация клиента

![Настройка перенаправления журналов на сервер по TCP 514](image/6.png){#fig-6 width=70%}


## Просмотр журнала

- Выполнен просмотр `/var/log/messages` с помощью `tail -f`
- Отображаются записи `server` и `client`
- Подтверждён приём удалённых журналов

![Просмотр журнала /var/log/messages на сервере](image/7.png){#fig-7 width=70%}

---


- Запущена программа `gnome-system-monitor`
- Отображены процессы, PID, использование CPU и памяти

![Запуск gnome-system-monitor на сервере](image/8.png){#fig-8 width=70%}

---

- Установлен пакет `lnav` через `dnf`
- Подтверждена успешная установка версии `0.11.1-1.el9`

![Установка lnav на сервере](image/9.png){#fig-9 width=70%}

---

- Выполнен просмотр журналов с помощью `lnav`
- Отображаются записи сервера и клиента
- Видны сообщения `systemd`, `rsyslog`, `cupsd`

![Просмотр журналов сервера в lnav](image/10.png){#fig-10 width=70%}

---

- Установлен пакет `lnav` на клиенте
- Подтверждена подготовка к установке

![Установка lnav на клиенте](image/11.png){#fig-11 width=70%}

---

- Выполнен просмотр журналов клиента через `lnav`
- Отображаются записи `systemd`, `rsyslog`, `packagekit`
- Подтверждена корректная работа логирования

![Просмотр журналов клиента в lnav](image/12.png){#fig-12 width=70%}


## Внесение изменений в настройки внутреннего

- Переход в `/vagrant/provision/server`
- Создание каталога `netlog/etc/rsyslog.d`
- Копирование `netlog-server.conf`
- Подготовка структуры provisioning

![Создание каталога netlog и копирование конфигурации rsyslog](image/13.png){#fig-13 width=70%}

---

- Создан исполняемый скрипт `netlog.sh`
- Назначены права выполнения
- Добавлена автоматическая настройка
- Копирование файлов в `/etc`
- Восстановление контекстов SELinux
- Открытие порта 514
- Перезапуск `rsyslog`

![Содержимое скрипта netlog.sh для автоматической настройки](image/14.png){#fig-14 width=70%}

---

- Переход в `/vagrant/provision/client`
- Создание каталога `netlog/etc/rsyslog.d`
- Копирование `netlog-client.conf`

![Создание каталога netlog и копирование конфигурации клиента](image/15.png){#fig-15 width=70%}

---

- Создан исполняемый файл `netlog.sh`
- Добавлен сценарий автоматической настройки клиента
- Установка `lnav`
- Копирование файлов в `/etc`
- Восстановление контекстов SELinux
- Перезапуск `rsyslog`

![Содержимое скрипта netlog.sh на клиенте](image/16.png){#fig-16 width=70%}

---

- В `Vagrantfile` добавлен блок provisioning для сервера
- Указан скрипт `provision/server/netlog.sh`
- Сохранена последовательность выполнения

![Добавление provisioning для сервера в Vagrantfile](image/17.png){#fig-17 width=70%}

---

- Добавлен аналогичный блок для клиента
- Указан скрипт `provision/client/netlog.sh`
- Обеспечена автоматическая настройка при запуске ВМ

![Добавление provisioning для клиента в Vagrantfile](image/18.png){#fig-18 width=70%}


# Выводы

## Выводы

- Настроено централизованное журналирование на базе `rsyslog`
- Организован приём журналов по TCP 514 на сервере
- Реализовано перенаправление сообщений с клиента
- Подтверждена корректность работы через `/var/log/messages` и `lnav`
- Реализована автоматизация через provisioning-скрипты
- Обеспечена воспроизводимость конфигурации
- Создана функционирующая система централизованного сбора журналов


