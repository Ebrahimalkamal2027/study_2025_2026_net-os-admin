---
## Author
author:
  name: Ибрахим Мохсейн Алькамаль
  degrees: Student (3 курс)
  orcid: ""
  email: 1032225432@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №9
subtitle: "Дисциплина: Администрирование сетевых подсистем "
license: CC BY
date: today
date-format: "YYYY-MM-DD" # Example: 2025-09-06
---

# Цель работы

## Цель работы

- Приобретение практических навыков установки POP3/IMAP-сервера
- Освоение базовой конфигурации почтового сервиса

# Выполнение лабораторной работы

## Установка Dovecot

- Переход в режим суперпользователя (`sudo -i`)
- Установка пакетов `dovecot` и `telnet` через `dnf`
- Разрешение зависимостей и установка RPM-пакетов

![Установка пакетов dovecot и telnet через dnf](image/1.png){#fig-1 width=70%}



## Настройка Dovecot

- В файле `/etc/dovecot/dovecot.conf` заданы протоколы `imap` и `pop3`
- Разрешена работа сервиса по IMAP и POP3

![Настройка параметра protocols в dovecot.conf](image/2.png){#fig-2 width=70%}

---

- В файле `10-auth.conf` проверен параметр `auth_mechanisms = plain`
- Подтверждён механизм аутентификации PLAIN

![Параметр auth\_mechanisms в 10-auth.conf](image/3.png){#fig-3 width=70%}

---

- В файле `auth-system.conf.ext` указан `driver = pam`
- Для userdb используется `driver = passwd`
- Используются системные учётные записи

![Параметры passdb и userdb в конфигурации Dovecot](image/4.png){#fig-4 width=70%}

---

![Параметры passdb и userdb в конфигурации Dovecot](image/5.png){#fig-5 width=70%}

---

- В файле `10-mail.conf` задано `mail_location = maildir:~/Maildir`
- Используется формат хранения Maildir

![Настройка mail\_location в конфигурации Dovecot](image/6.png){#fig-6 width=70%}

---

- В Postfix задан параметр `home_mailbox = Maildir/`
- Обеспечена совместимость доставки с Maildir

![Настройка параметра home\_mailbox в Postfix](image/7.png){#fig-7 width=70%}

---

- В firewalld добавлены службы POP3, POP3S, IMAP, IMAPS
- Выполнена перезагрузка конфигурации
- Подтверждён список активных служб

![Настройка служб POP3 и IMAP в firewalld](image/8.png){#fig-8 width=70%}

---

- Выполнена команда `restorecon -vR /etc`
- Восстановлены контексты SELinux
- Обеспечена корректная работа служб

![Восстановление контекста SELinux](image/8.png){#fig-8 width=70%}

---

- Перезапущен Postfix
- Активирована служба Dovecot через `systemctl`
- Подтверждён успешный запуск служб

![Запуск и активация служб Postfix и Dovecot](image/9.png){#fig-9 width=70%}



## Проверка работы Dovecot

- Запущен мониторинг `tail -f /var/log/maillog`
- Зафиксирован запуск Postfix и Dovecot
- Подтверждена корректная работа служб

![Мониторинг работы почтовых служб в журнале maillog](image/10.png){#fig-10 width=70%}

---

- Выполнена команда `MAIL=~/Maildir mail`
- Обнаружено отсутствие каталога `/root/Maildir`
- Почтовый ящик root не создан

![Проверка наличия почтового ящика пользователя root](image/11.png){#fig-11 width=70%}

---

- Выполнена команда `doveadm mailbox list -u alkamal`
- Отображён почтовый ящик `INBOX`
- Подтверждено создание mailbox пользователя

![Просмотр списка mailbox пользователя alkamal](image/12.png){#fig-12 width=70%}

---

- На клиенте установлен пакет `evolution`
- Выполнена установка через `dnf`
- Зависимости успешно разрешены

![Установка почтового клиента Evolution на клиентской машине](image/13.png){#fig-13 width=70%}

---

- В Evolution указаны имя `alkamal` и адрес `alkamal@alkamal.net`
- Выбран режим ручной настройки

![Настройка идентификационных данных в Evolution](image/14.png){#fig-14 width=70%}

---

- Выбран протокол IMAP
- Сервер `mail.alkamal.net`, порт 143
- Шифрование STARTTLS
- Аутентификация — обычный пароль

![Настройка параметров IMAP в Evolution](image/15.png){#fig-15 width=70%}

---

- Указан SMTP-сервер `mail.alkamal.net`, порт 25
- Соединение без дополнительного шифрования
- Тип аутентификации — PLAIN

![Настройка параметров SMTP в Evolution](image/16.png){#fig-16 width=70%}

---

- Подтверждены параметры IMAP и SMTP
- Проверен сервер и пользователь

![Сводка параметров учётной записи Evolution](image/17.png){#fig-17 width=70%}

---

- Отправлены тестовые сообщения
- Письма `Test1`, `test2`, `test3` получены
- Подтверждена корректная доставка

![Получение тестовых писем в Evolution](image/18.png){#fig-18 width=70%}

---

- Выполнено подключение `telnet mail.alkamal.net 110`
- Установлено соединение с Dovecot
- Команда `list` отобразила три сообщения

![Подключение к POP3 и получение списка писем](image/20.png){#fig-20 width=70%}

---

- Команда `retr 1` — получено письмо
- Команда `dele 2` — письмо помечено к удалению
- Команда `quit` — завершение сеанса с удалением

![Получение и удаление письма по протоколу POP3](image/20.png){#fig-20 width=70%}



## Внесение изменений в настройки внутреннего

- Переход в `/vagrant/provision/server`
- Создана структура `mail/etc/dovecot/conf.d`
- Скопированы файлы конфигурации Dovecot
- Подготовка к автоматическому провижинингу

![Копирование конфигурационных файлов Dovecot в каталог provision](image/21.png){#fig-21 width=70%}

---

- В `mail.sh` добавлена установка `dovecot` и `telnet`
- Открыты службы SMTP, POP3, POP3S, IMAP, IMAPS
- Задан `home_mailbox = Maildir/`
- Выполнены `restorecon`, перезапуск Postfix и запуск Dovecot
- Реализована автоматическая настройка сервера

![Изменённый скрипт mail.sh для сервера](image/22.png){#fig-22 width=70%}

---

- В `client/mail.sh` добавлена установка `evolution`
- Автоматизирована настройка клиентской части

![Изменение скрипта mail.sh на клиенте](image/23.png){#fig-23 width=70%}


# Выводы
## Выводы

- Установлены и настроены Postfix и Dovecot
- Настроена доставка почты в формате Maildir
- Реализована аутентификация через PAM и passwd
- Обеспечена работа IMAP и POP3
- Настроен firewalld и восстановлены контексты SELinux
- Выполнена проверка через журнал, mail, doveadm и Telnet
- Подтверждена работа клиента Evolution
- Реализована интеграция конфигурации в Vagrant
- Обеспечена воспроизводимость почтовой системы
