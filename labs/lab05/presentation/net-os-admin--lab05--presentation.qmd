---
## Author
author:
  name: Ибрахим Мохсейн Алькамаль
  degrees: Student (3 курс)
  orcid: ""
  email: 1032225432@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №5
subtitle: "Дисциплина: Администрирование сетевых подсистем "
license: CC BY
date: today
date-format: "YYYY-MM-DD" # Example: 2025-09-06
---

# Цель работы
## Цель работы
- Приобретение практических навыков расширенного конфигурирования HTTP-сервера Apache
- Настройка безопасности (HTTPS)
- Интеграция поддержки PHP


# Выполнение лабораторной работы

## Конфигурирование HTTP-сервера для работы через протокол HTTPS

- В каталоге `/etc/pki/tls/private` создан закрытый ключ и самоподписанный сертификат
- Использована команда `openssl req -x509 -nodes -newkey rsa:2048`
- Заданы параметры DN (RU, Russia, Moscow, alkamal, CN=alkamal.net)
- Сертификат скопирован в `/etc/ssl/certs`

![Генерация самоподписанного SSL-сертификата и закрытого ключа OpenSSL](image/1.png){#fig-1 width=70%}

---

- Отредактирован файл `www.alkamal.net.conf`
- В `<VirtualHost *:80>` настроена переадресация на HTTPS (`RewriteRule`)
- В `<VirtualHost *:443>` включён `SSLEngine on`
- Указаны `SSLCertificateFile` и `SSLCertificateKeyFile`
- Настроены журналы и `DocumentRoot`

![Конфигурация виртуального хоста Apache для HTTPS](image/2.png){#fig-2 width=70%}

---

- Проверены активные сервисы firewalld
- Добавлен сервис `https`
- Правила сохранены как постоянные
- Выполнен перезапуск `httpd`

![Настройка firewalld и перезапуск службы httpd](image/3.png){#fig-3 width=70%}

---

- На клиенте открыт `https://www.alkamal.net`
- Выполнено перенаправление HTTP → HTTPS
- После подтверждения исключения отображается страница
- Подтверждена работа HTTPS

![Доступ к веб-серверу по HTTPS в браузере клиента](image/4.png){#fig-4 width=70%}



## Конфигурирование HTTP-сервера для работы с PHP

- Выполнена установка пакета `php` через `dnf`
- Установлена версия PHP 8.0.30
- Установлены необходимые зависимости

![Установка пакета PHP с помощью dnf](image/5.png){#fig-5 width=70%}

---

- Удалён `index.html`
- Создан файл `index.php` с `phpinfo();`
- Выполнен `chown -R apache:apache /var/www`
- Восстановлены SELinux-контексты
- Перезапущен `httpd`

![Создание index.php, настройка прав доступа и перезапуск httpd](image/6.png){#fig-6 width=70%}

---

- На клиенте открыт `www.alkamal.net`
- Отображена страница `phpinfo()`
- Подтверждена интеграция PHP с Apache

![Отображение страницы phpinfo() в браузере клиента](image/7.png){#fig-7 width=70%}


## Внесение изменений в настройки внутреннего окружения виртуальной машины

- Скопированы конфигурации из `/etc/httpd/conf.d`
- Скопирован веб-контент из `/var/www/html`
- Созданы каталоги для ключей и сертификатов в provision
- Помещены файлы `www.alkamal.net.key` и `www.alkamal.net.crt`

![Копирование конфигурации HTTP и SSL в каталог provision](image/8.png){#fig-8 width=70%}

---

- В `http.sh` добавлена установка `php`
- Реализовано копирование конфигураций в `/etc/httpd` и `/var/www`
- Настроен владелец `apache`
- Восстановлены SELinux-контексты
- Добавлены правила firewalld для `http` и `https`
- Настроен запуск и включение `httpd`

![Изменённый скрипт http.sh с установкой PHP и настройкой HTTPS](image/9.png){#fig-9 width=70%}


# Выводы
## Выводы

- Настроен HTTPS с использованием самоподписанного сертификата
- Реализована переадресация HTTP → HTTPS
- Открыт сервис `https` в firewall
- Установлен и интегрирован PHP с Apache
- Подтверждена обработка PHP-скриптов (`phpinfo()`)
- Конфигурация перенесена в provisioning-окружение
- Обеспечена воспроизводимость настройки через `http.sh`
