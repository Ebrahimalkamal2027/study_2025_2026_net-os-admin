---
## Author
author:
  name: Ибрахим Мохсейн Алькамаль
  degrees: Student (3 курс)
  orcid: ""
  email: 1032225432@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №2
subtitle: "Дисциплина: Администрирование сетевых подсистем "
license: CC BY
date: today
date-format: "YYYY-MM-DD" # Example: 2025-09-06
---

# Цель работы
## Цель работы

- Формулировка цели лабораторной работы согласно методическим указаниям
- Упрощение подготовки отчётов с использованием шаблона
- Ознакомление с возможностями разметки Markdown


# Выполнение лабораторной работы

## Установка DNS-сервера

- Выполнен вход под пользователем `alkamal`
- Переход в режим суперпользователя `sudo -i`
- Подтверждена смена приглашения на `root`

![Переход в режим суперпользователя sudo -i](image/1.png){#fig-1 width=70%}

---

- Установлены пакеты `bind` и `bind-utils`
- Использована команда `dnf -y install`
- Транзакция завершена успешно

![Установка пакетов bind и bind-utils через dnf](image/2.png){#fig-2 width=70%}

---

- Выполнен запрос `dig www.yandex.ru`
- Статус ответа `NOERROR`
- Получены три A-записи
- Подтверждено корректное разрешение имени

![Результат запроса dig www.yandex.ru](image/3.png){#fig-3 width=70%}



## Конфигурирование кэширующего DNS-сервера

- Проанализирован `/etc/resolv.conf`
- Указан домен `alkamal.net`
- Заданы внешние DNS-серверы

![Содержимое файла /etc/resolv.conf](image/4.png){#fig-4 width=70%}

---

- Проанализирован `/etc/named.conf`
- Включена рекурсия `recursion yes`
- Прослушивание на `127.0.0.1`
- Разрешены запросы от localhost

![Конфигурация файла /etc/named.conf](image/5.png){#fig-5 width=70%}

---

- Рассмотрен файл `named.ca`
- Содержит корневые NS, A, AAAA-записи

![Содержимое файла named.ca (корневые серверы)](image/6.png){#fig-6 width=70%}

---

- Рассмотрен файл `named.localhost`
- Определена зона localhost

![Содержимое файла named.localhost](image/7.png){#fig-7 width=70%}

---

- Рассмотрен файл `named.loopback`
- Настроено обратное разрешение 127.0.0.1

![Содержимое файла named.loopback](image/8.png){#fig-8 width=70%}

---

- Выполнены `systemctl start named` и `enable named`
- Сравнены запросы `dig`
- Локальный сервер не отвечал до изменения настроек

![Проверка работы named и сравнение запросов dig](image/9.png){#fig-9 width=70%}

---

- Через `nmcli` установлен DNS 127.0.0.1
- Отключён auto-DNS
- После перезапуска изменён `/etc/resolv.conf`

![Настройка DNS через nmcli и проверка resolv.conf](image/10.png){#fig-10 width=70%}

---

- В `named.conf` добавлено `listen-on {127.0.0.1; any;}`
- Разрешены запросы от 192.168.0.0/16
- В firewall открыт сервис DNS

![Изменение параметров listen-on и allow-query](image/11.png){#fig-11 width=70%}

---

- Проверено прослушивание порта 53
- Процесс `named` активен (UDP)

![Проверка прослушивания порта 53 процессом named](image/12.png){#fig-12 width=70%}

---

- Добавлены `forwarders {127.0.0.1;}`
- Установлен `forward first`
- Отключены `dnssec-enable` и `dnssec-validation`

![Добавление forwarders и отключение DNSSEC в named.conf](image/13.png){#fig-13 width=70%}



## Конфигурирование первичного DNS-сервера

- Скопирован `named.rfc1912.zones`
- Переименован в `alkamal.net`
- Подключён через `include` в `named.conf`

![Копирование и подключение файла зоны alkamal.net в named.conf](image/14.png){#fig-14 width=70%}

---

- Определена прямая зона `alkamal.net`
- Определена обратная зона `1.168.192.in-addr.arpa`
- Указаны файлы зон

![Определение прямой и обратной зон в файле alkamal.net](image/16.png){#fig-16 width=70%}

---

- Созданы каталоги `master/fz` и `master/rz`
- Подготовлен файл прямой зоны

![Создание каталогов master/fz и master/rz и подготовка файла прямой зоны](image/17.png){#fig-17 width=70%}

---

- Настроен файл обратной зоны
- Указан `$TTL 1D`
- Добавлена SOA-запись
- Установлен серийный номер
- Добавлены A- и PTR-записи
- Установлен `$ORIGIN`

![Настройка файла обратной DNS-зоны 192.168.1](image/18.png){#fig-18 width=70%}

---

- Восстановлены SELinux-контексты
- Активирован `named_write_master_zones`
- Выполнен `systemctl restart named`

![Восстановление SELinux-контекста и перезапуск службы named](image/20.png){#fig-20 width=70%}


## Проверка работоспособности первичного DNS-сервера

- Выполнен `dig ns.alkamal.net`
- Статус `NOERROR`
- Получена A-запись 192.168.1.1
- Сервер 127.0.0.1#53

![Результат выполнения команды dig для ns.alkamal.net](image/21.png){#fig-21 width=70%}

---

- Выполнена передача зоны `host -l alkamal.net`
- Отображены NS- и A-записи
- Подтверждена корректность прямой зоны

![Вывод команды host -l для зоны alkamal.net](image/22.png){#fig-22 width=70%}

---

- Выполнен запрос `host -a alkamal.net`
- Отображены SOA, NS, A-записи
- Проверен серийный номер зоны

![Расширенный запрос host -a для alkamal.net](image/23.png){#fig-23 width=70%}

---

- Проверено прямое разрешение `A`
- Проверено обратное разрешение `PTR`
- Подтверждена корректность зоны 1.168.192.in-addr.arpa

![Проверка A- и PTR-записей зоны alkamal.net](image/24.png){#fig-24 width=70%}



## Внесение изменений в настройки внутреннего окружения виртуальной машины

- Созданы каталоги в `/vagrant/provision/server/dns`
- Скопированы `named.conf` и файлы зон
- Подготовлена структура provisioning

![Подготовка структуры каталогов и копирование конфигурации DNS в /vagrant](image/25.png){#fig-25 width=70%}

---

- Создан исполняемый скрипт `dns.sh`
- Установка `bind` и `bind-utils`
- Копирование файлов в `/etc` и `/var/named`
- Изменение владельца на `named:named`
- Восстановление SELinux-контекстов
- Открытие DNS в firewall
- Включение `named_write_master_zones`
- Установка DNS 127.0.0.1
- Запуск и включение `named`

![Содержимое provisioning-скрипта dns.sh](image/26.png){#fig-26 width=70%}

---

- В `Vagrantfile` добавлен provision-блок `shell`
- Указан путь `provision/server/dns.sh`
- Сохранена последовательность выполнения

![Добавление provisioning-скрипта dns.sh в конфигурацию Vagrantfile](image/27.png){#fig-27 width=70%}


# Выводы
## Выводы

- Установлен и настроен DNS-сервер BIND
- Реализован режим кэширующего и первичного сервера
- Настроены зоны `alkamal.net` и `1.168.192.in-addr.arpa`
- Созданы корректные A- и PTR-записи
- Подтверждена авторитетность сервера
- Открыт DNS в firewall
- Настроены параметры SELinux
- Сервер назначен DNS по умолчанию (127.0.0.1)
- Реализована автоматизация через `dns.sh` и `Vagrantfile`
